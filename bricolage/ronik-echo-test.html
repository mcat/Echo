<!DOCTYPE html>
<html>
<head>
    <script src="js/libs/jquery-1.7.1.js"></script>
    <script src="js/mylibs/underscore.js"></script>
    <script src="js/mylibs/jquery.ba-tinypubsub.min.js"></script>
    <script src="js/mylibs/ronik-echo.js"></script>
    <script>
        var topic = "/echo/search";

        new Ronik.EchoStream({
            query: "childrenof:ronikdesign.com/test.html",
            topic: topic
        }).start();

        var posts = {};

        $.subscribe(topic, function(event, data){
            $.each(data.entries, function(){
                if(!posts[this.object.id]) {
                    var $element = $('<div class="post">' + this.object.content + '</div>');
                    posts[this.object.id] = $element;

                    var parentId = this.targets[0].id;
                    if(posts[parentId]) {
                        posts[parentId].append($element);
                    } else {
                        $("#echo-stream").prepend($element);
                    }
                }
            });
        });
    </script>
    <style>
        .post { margin-left: 20px; }
    </style>
</head>
<body>
<div id="echo-stream"></div>
</body>
</html>